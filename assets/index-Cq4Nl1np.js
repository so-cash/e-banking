import{_ as F,V as O}from"./filter-W8oclBAH.js";import{A as P,e as i,D as E,r as d,o as $,$ as j,N as f,c as o,E as H,F as s,S as J,M as u,H as v,I as c,P as m,y as R,J as A,O as D}from"./index-BI4dhWSs.js";import{u as U}from"./accounts-D7WxMkEl.js";import{s as Y,a as q,t as k,b as z,c as G}from"./formatting-CrmIf10V.js";import{g as h,i as T}from"./VCard-Ca1lIbYd.js";import{V as K,a as Q}from"./VHover-Bujy_-1z.js";import{a as W}from"./VInput-BgACklH0.js";import{_ as X}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./VSelect-DJ_nTOQV.js";import"./VTextField-D8IjpR-w.js";import"./VChip-j1TCQZRM.js";const Z={key:1,class:"d-flex justify-center"},ee={key:0},te={class:"text-caption"},ae={key:0,class:"text-caption"},se=P({__name:"index",setup(ne){const t=U(),V=i(()=>E().params.address.toString()),w=i(()=>t.selectedAccount),n=i(()=>{var a;return(a=t.selectedAccount)==null?void 0:a.account}),B=i(()=>{var a;return((a=t.selectedAccount)==null?void 0:a.transactions)||[]}),C=i(()=>{var a;return(a=n.value)==null?void 0:a.bank.currency}),l=d(),p=d(),L=d(0),S=d(0),_=d(!1);let b;async function x(){if(n.value){_.value=!0,p.value=new Date;try{const a=l.value,r=l.value?S.value:n.value.balance;l.value=l.value?new Date(Y(l.value.getTime())):new Date(q(Date.now()));const g=await t.loadTransactions(n.value,{from:l.value,to:a},t.selectedAccount.transactions);t.selectedAccount.transactions||(t.selectedAccount.transactions=[]),t.selectedAccount.transactions=g}finally{_.value=!1}}}async function I(){if(!n.value)return;const a=new Date(Date.now()-4e3);try{const r=await t.loadTransactions(n.value,{from:p.value,to:a},t.selectedAccount.transactions);t.selectedAccount.transactions||(t.selectedAccount.transactions=[]),t.selectedAccount.transactions=r}finally{p.value=a}}$(async()=>{t.selectedAccount={account:await t.loadAccount(V.value)},L.value=n.value.balance,x(),b=setInterval(()=>{I()},5e3)}),j(()=>{b&&clearInterval(b)});const M=i(()=>[{title:"Date",value:"date",align:"start"},{title:"Label",value:"label",align:"start"},{title:"Credit",value:"credit",align:"end"},{title:"Debit",value:"debit",align:"end"},{title:"Balance "+C.value,value:"balance",align:"end"}]);return(a,r)=>{const g=F;return u(),f(J,null,[o(g,{selected:w.value},null,8,["selected"]),n.value?(u(),f("div",Z,[o(h,{elevation:"3",class:"mt-3 width-80"},{default:s(()=>[o(T,null,{default:s(()=>[o(K,{items:B.value,headers:M.value,hover:"","items-per-page":-1,"mobile-breakpoint":0},{"item.date":s(({item:e})=>[v(c(m(z)(e.date.getTime()))+" "+c(m(G)(e.date.getTime())),1)]),"item.label":s(({item:e})=>[o(Q,{"open-delay":1e3},{default:s(({isHovering:y,props:N})=>[o(h,R(N,{class:y?"bg-grey-lighten-2":"",elevation:y?2:0}),{default:s(()=>[o(T,{class:"pa-2"},{default:s(()=>[A("div",null,c(e.details.details),1),A("div",null,c(e.details.recipient.iban??e.details.recipient.bic),1),y?(u(),f("div",ee,[A("div",te,c(e.cpty),1),e.details.reason?(u(),f("div",ae,c(e.details.reason),1)):D("",!0)])):D("",!0)]),_:2},1024)]),_:2},1040,["class","elevation"])]),_:2},1024)]),"item.credit":s(({item:e})=>[v(c(e.credit>0?m(k)(e.credit,n.value.bank.decimals):"."),1)]),"item.debit":s(({item:e})=>[v(c(e.debit>0?m(k)(e.debit,n.value.bank.decimals):"."),1)]),"item.balance":s(({item:e})=>[v(c(m(k)(e.balanceAfter,n.value.bank.decimals)),1)]),bottom:s(()=>[o(W,{onClick:x,loading:_.value},{default:s(()=>r[0]||(r[0]=[v("Load more")])),_:1},8,["loading"])]),_:1},8,["items","headers"])]),_:1})]),_:1})])):(u(),H(O,{key:0,elevation:3,type:"card"}))],64)}}}),_e=X(se,[["__scopeId","data-v-fae91e60"]]);export{_e as default};
