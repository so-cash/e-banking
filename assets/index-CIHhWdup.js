import{_ as F,V as O}from"./filter-CJ8vjxkn.js";import{A as P,f as i,r,o as R,a1 as j,N as m,c as l,D as E,F as s,R as J,I as u,J as d,K as c,O as v,y as K,M as A,P as k,C as U}from"./index-CjOFXEkW.js";import{u as Y}from"./accounts-CDDCG86r.js";import{s as $,a as q,b as z,c as G,t as x}from"./formatting-CrmIf10V.js";import{g as D,i as T}from"./VCard-B3Oprnt7.js";import{V as H,a as Q}from"./VHover-DMpG539J.js";import{a as W}from"./VInput-CZnSWQNW.js";import"./VSelect-omC-gu8C.js";import"./VTextField-BeZf-9lP.js";import"./VChip-Bl0RUETQ.js";const X={key:1,class:"d-flex justify-center"},Z={key:0},ee={class:"text-caption"},te={key:0,class:"text-caption"},me=P({__name:"index",setup(ae){const t=Y(),V=i(()=>U().params.address.toString()),w=i(()=>t.selectedAccount),n=i(()=>{var a;return(a=t.selectedAccount)==null?void 0:a.account}),B=i(()=>{var a;return((a=t.selectedAccount)==null?void 0:a.transactions)||[]}),C=i(()=>{var a;return(a=n.value)==null?void 0:a.bank.currency}),o=r(),f=r(),L=r(0),M=r(0),p=r(!1);let _;async function h(){if(n.value){p.value=!0,f.value=new Date;try{const a=o.value,b=o.value?M.value:n.value.balance;o.value=o.value?new Date($(o.value.getTime())):new Date(q(Date.now()));const g=await t.loadTransactions(n.value,{from:o.value,to:a},t.selectedAccount.transactions);t.selectedAccount.transactions||(t.selectedAccount.transactions=[]),t.selectedAccount.transactions=g}finally{p.value=!1}}}async function N(){if(!n.value)return;const a=new Date(Date.now()-4e3);try{const b=await t.loadTransactions(n.value,{from:f.value,to:a},t.selectedAccount.transactions);t.selectedAccount.transactions||(t.selectedAccount.transactions=[]),t.selectedAccount.transactions=b}finally{f.value=a}}R(async()=>{t.selectedAccount={account:await t.loadAccount(V.value)},L.value=n.value.balance,h(),_=setInterval(()=>{N()},5e3)}),j(()=>{_&&clearInterval(_)});const S=i(()=>[{title:"Date",value:"date",align:"start"},{title:"Label",value:"label",align:"start"},{title:"Credit",value:"credit",align:"end"},{title:"Debit",value:"debit",align:"end"},{title:"Balance "+C.value,value:"balance",align:"end"}]);return(a,b)=>{const g=F;return u(),m(J,null,[l(g,{selected:w.value},null,8,["selected"]),n.value?(u(),m("div",X,[l(D,{elevation:"3",class:"mt-3 flex-lg-0-0 flex-sm-fill"},{default:s(()=>[l(T,null,{default:s(()=>[l(H,{items:B.value,headers:S.value,hover:"","items-per-page":-1},{"item.date":s(({item:e})=>[d(c(v(z)(e.date.getTime()))+" "+c(v(G)(e.date.getTime())),1)]),"item.label":s(({item:e})=>[l(Q,{"open-delay":1e3},{default:s(({isHovering:y,props:I})=>[l(D,K(I,{class:y?"bg-grey-lighten-2":"",elevation:y?2:0}),{default:s(()=>[l(T,{class:"pa-2"},{default:s(()=>[A("div",null,c(e.details.details),1),A("div",null,c(e.details.recipient.iban??e.details.recipient.bic),1),y?(u(),m("div",Z,[A("div",ee,c(e.cpty),1),e.details.reason?(u(),m("div",te,c(e.details.reason),1)):k("",!0)])):k("",!0)]),_:2},1024)]),_:2},1040,["class","elevation"])]),_:2},1024)]),"item.credit":s(({item:e})=>[d(c(e.credit>0?v(x)(e.credit,n.value.bank.decimals):"."),1)]),"item.debit":s(({item:e})=>[d(c(e.debit>0?v(x)(e.debit,n.value.bank.decimals):"."),1)]),"item.balance":s(({item:e})=>[d(c(v(x)(e.balanceAfter,n.value.bank.decimals)),1)]),bottom:s(()=>[l(W,{onClick:h,loading:p.value},{default:s(()=>[d("Load more")]),_:1},8,["loading"])]),_:1},8,["items","headers"])]),_:1})]),_:1})])):(u(),E(O,{key:0,elevation:3,type:"card"}))],64)}}});export{me as default};
